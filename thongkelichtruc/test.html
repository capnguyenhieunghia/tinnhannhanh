<!DOCTYPE html>
<html>

<head>
  <title>Phân công lịch trực</title>
  <style>
    table {
      width: 100%;
      border-collapse: collapse;
    }

    th,
    td {
      padding: 8px;
      text-align: left;
      border-bottom: 1px solid #ddd;
    }

    th {
      background-color: #f2f2f2;
    }
  </style>
</head>

<body>
  <h1>Phân công lịch trực</h1>
  <table id="shiftTable">
    <thead>
      <tr>
        <th>Tên</th>
        <th>Ngày trực</th>
        <th>Thứ trực</th>
        <th>Buổi trực</th>
        <th>Giờ trực</th>
        <th>Giờ trực</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    fetch('https://docs.google.com/spreadsheets/d/1StDAeGsPGsz6g94QAAT4MkxNGJib_-77KZT3lmrSYgo/export?format=csv')
      .then(response => response.text())
      .then(data => {
        const rows = data.trim().split('\n');
        const tableBody = document.querySelector('#shiftTable tbody');

        rows.slice(1).forEach(row => {
          const [name, date, day, shift, hours] = row.split(',');
          const totalHours = calculateTotalHours(shift, hours);

          const tr = document.createElement('tr');
          tr.innerHTML = `
            <td>${name}</td>
            <td>${date}</td>
            <td>${day}</td>
            <td>${shift}</td>
            <td>${hours}</td>
            <td>${totalHours.slice(0, -3)}</td>
          `;
          tableBody.appendChild(tr);
        });
      })
      .catch(error => console.error(error));

    function calculateTotalHours(shift, hours) {
      const [start, end] = hours.split(' - ');
      const [startHour, startMinute] = start.split(':');
      const [endHour, endMinute] = end.split(':');

      const startTime = new Date();
      startTime.setHours(parseInt(startHour), parseInt(startMinute), 0, 0);

      const endTime = new Date();
      endTime.setHours(parseInt(endHour), parseInt(endMinute), 0, 0);

      const totalMilliseconds = endTime.getTime() - startTime.getTime();
      const totalHours = totalMilliseconds / (1000 * 60 * 60);

      return totalHours.toFixed(2);
    }
  </script>
</body>

</html>